# -*- coding: utf-8 -*-
"""
Created on Thu Aug  4 18:34:51 2022

@author: Acer
"""

import pandas as pd
import string
import json
import spacy

from gensim import corpora

from nltk.tokenize import word_tokenize
import nltk
nltk.download('punkt')

def case_participation(filename, limit):
    """
    Make a dictionary author2doc of which cases (documents) each justice
    participates in
    """

    with open(filename, "r") as a_file:
        author2doc = a_file.read()

        author2doc = json.loads(author2doc) #convert str to dict
        print('author2doc:', author2doc)

    # Remove all out of range documents
    for author in author2doc:
        print('author:', author)
        author2doc[author] = [x for x in author2doc[author] if x < limit]
    
    return author2doc

def clean_text(text):
    #print('text:', text)
    #with open("stop_words_Nov_08_2022.txt", "r") as fp:
    #with open("stop_words_Aug_01_2022.txt", "r") as fp:
    #    stop_words = json.load(fp)
    stop_words = ['bundesverfassungsgericht', 'namen', 'volkes', 'verfahren', 'über', 'verfassungsbeschwerde', 'herrn', 'bevollmächtigter', 'gegen', 'beschluss', 'oberlandesgerichts', 'januar', 'landgerichts', 'verfügung', 'staatsanwaltschaft', 'november', 'hier', 'antrag', 'erlass', 'einer', 'einstweiligen', 'anordnung', 'kammer', 'zweiten', 'senats', 'bundesverfassungsgerichts', 'durch', 'könig', 'richter', 'müller', 'maidowski', 'juli', 'einstimmig', 'beschlossen', 'erklärung', 'zulässigkeit', 'vollstreckung', 'beschwerdeführer', 'ergangenen', 'urteils', 'zweiter', 'instanz', 'senat', 'urteil', 'wird', 'entscheidung', 'beschwerdeführers', 'hauptsache', 'dauer', 'sechs', 'monaten', 'absatz', 'satz', 'ausgesetzt', 'wendet', 'sich', 'seiner', 'einem', 'verbundenen', 'entscheidungen', 'rahmen', 'eines', 'denen', 'freiheitsstrafe', 'zulässig', 'erklärt', 'wurde', 'hatte', 'wegen', 'oder', 'gemäß', 'seit', 'jahren', 'acht', 'verurteilt', 'eine', 'rügt', 'dass', 'verstoßen', 'worden', 'weil', 'verurteilung', 'habe', 'daneben', 'grundsatz', 'verfahrens', 'rechtlichen', 'gehörs', 'verletzt', 'während', 'bestimmte', 'unterlagen', 'nicht', 'deutsche', 'seien', 'sieht', 'dadurch', 'seinen', 'grundrechten', 'verbindung', 'sowie', 'nordrheinwestfalen', 'unter', 'gelegenheit', 'stellungnahme', 'gegeben', 'abgesehen', 'begründet', 'nach', 'bverfgg', 'kann', 'streitfall', 'einen', 'zustand', 'einstweilige', 'vorläufig', 'regeln', 'wenn', 'dies', 'abwehr', 'schwerer', 'nachteile', 'anderen', 'wichtigen', 'grund', 'gemeinen', 'wohl', 'dringend', 'geboten', 'dabei', 'haben', 'gründe', 'verfassungswidrigkeit', 'angegriffenen', 'vorgetragen', 'werden', 'grundsätzlich', 'außer', 'betracht', 'bleiben', 'denn', 'vornherein', 'unzulässig', 'offensichtlich', 'unbegründet', 'ausgang', 'muss', 'folgen', 'eintreten', 'würden', 'aber', 'erfolg', 'hätte', 'entstünden', 'begehrte', 'erlassen', 'würde', 'versagen', 'wäre', 'bverfge', 'strspr', 'gemessen', 'hieran', 'weder', 'noch', 'erhebliche', 'umfang', 'beginn', 'rechnung', 'getragen', 'infolge', 'zugunsten', 'erweist', 'später', 'jedoch', 'damit', 'erheblicher', 'eingriff', 'recht', 'freiheit', 'person', 'verbunden', 'grundrechtlich', 'rechten', 'besonderes', 'gewicht', 'zukommt', 'demgegenüber', 'obwohl', 'letztlich', 'versagt', 'weniger', 'schwer', 'diesem', 'fall', 'zwar', 'oben', 'genannte', 'nachteil', 'allgemeinheit', 'öffentlichen', 'interesse', 'auch', 'zurückweisung', 'oktober', 'amtsgerichts', 'februar', 'ersten', 'masing', 'paulus', 'fassung', 'bekanntmachung', 'august', 'bgbl', 'angenommen', 'gegenstandslos', 'mehrfach', 'richtet', 'aufgrund', 'anderem', 'ließ', 'dessen', 'hintergrund', 'soll', 'angesichts', 'solle', 'daraufhin', 'partei', 'rechte', 'gebiet', 'artikel', 'zunächst', 'allgemein', 'fordert', 'dazu', 'ziehen', 'neuen', 'sogar', 'spricht', 'weiter', 'daher', 'einfluss', 'zeit', 'meinung', 'sind', 'staat', 'verhalten', 'sämtliche', 'staatliche', 'dieser', 'äußerungen', 'verurteilte', 'amtsgericht', 'ohne', 'berufung', 'wies', 'landgericht', 'zurück', 'wobei', 'begründung', 'wesentlichen', 'betroffene', 'werde', 'funktion', 'solche', 'öffentliche', 'verwendung', 'sinne', 'stgb', 'betroffenen', 'eindeutig', 'gehabt', 'nämlich', 'insofern', 'könne', 'bezugnahme', 'deutlich', 'insbesondere', 'bekannt', 'ziel', 'erreichen', 'hätten', 'personen', 'liege', 'gewalt', 'allerdings', 'kein', 'äußerung', 'stehe', 'inwieweit', 'müsse', 'entscheidend', 'vielmehr', 'lasse', 'gesetze', 'ausnahme', 'anerkannt', 'vorschriften', 'verhinderung', 'politischen', 'revision', 'verwarf', 'oberlandesgericht', 'bestätigt', 'ergänzend', 'bezug', 'nimmt', 'verletzung', 'anzunehmen', 'ungeachtet', 'frage', 'genügt', 'jedenfalls', 'auslegung', 'anwendung', 'fachgerichte', 'innerhalb', 'fachgerichtlichen', 'fachgerichten', 'greift', 'gerechtfertigt', 'unterliegt', 'grundrecht', 'allgemeinen', 'ergeben', 'eingriffe', 'müssen', 'danach', 'gesetz', 'gestützt', 'sein', 'blick', 'ordnung', 'genügen', 'geht', 'beurteilung', 'darauf', 'stützt', 'diese', 'betrifft', 'allein', 'erfordernis', 'kriterien', 'also', 'gesetzes', 'dementsprechend', 'verfassungsgemäß', 'erachtet', 'gerade', 'gesetzgeber', 'durfte', 'deutschen', 'stellen', 'steht', 'vorliegend', 'ausgehend', 'dort', 'genannten', 'ganz', 'verschiedene', 'betreffen', 'gilt', 'keine', 'allgemeine', 'anforderungen', 'grundgesetz', 'verbot', 'schon', 'wirkung', 'seines', 'inhalts', 'gelten', 'gewährleistet', 'unabhängig', 'bewertung', 'ihrer', 'erlaubt', 'staatlichen', 'sondern', 'erst', 'dann', 'erkennbar', 'auseinandersetzung', 'grundsätzen', 'ihre', 'konkrete', 'jeweiligen', 'nehmen', 'besonderen', 'damals', 'zumal', 'weitere', 'insoweit', 'regel', 'prüfen', 'liegt', 'einzelfall', 'ersichtlich', 'sonst', 'zusammenhang', 'stehen', 'darin', 'andere', 'liegen', 'bverfg', 'september', 'maßgeblich', 'bleibt', 'selbst', 'möglicherweise', 'diesen', 'tragen', 'bedeutung', 'gewahrt', 'maßstäben', 'keinen', 'verfassungsrechtlichen', 'bedenken', 'gerichte', 'einzelnen', 'nachvollziehbar', 'hingewiesen', 'mittels', 'seitens', 'unmittelbar', 'gegenüber', 'besonders', 'deutschland', 'klar', 'schließlich', 'weist', 'zutreffend', 'folgende', 'wollen', 'derartige', 'gerichtet', 'solchen', 'konkret', 'charakter', 'trägt', 'gefahr', 'lassen', 'gefährdet', 'deren', 'dagegen', 'schützt', 'unanfechtbar', 'berlin', 'dritten', 'ebenfalls', 'zeitraum', 'zwischen', 'stpo', 'eingestellt', 'erfolgte', 'dieses', 'beim', 'gemacht', 'stehende', 'form', 'strafverfahren', 'hierauf', 'gestellte', 'beabsichtigte', 'hinreichende', 'aussicht', 'umstände', 'konkreten', 'umständen', 'öffentlichkeit', 'begründeten', 'besondere', 'einschließlich', 'sofortige', 'beschwerde', 'ausschließlich', 'anspruchs', 'dürften', 'entschieden', 'halten', 'berücksichtigt', 'grundrechtlichen', 'anspruch', 'hinreichender', 'weise', 'ständiger', 'rechtsprechung', 'prozesskostenhilfe', 'weitgehend', 'gleichen', 'zugang', 'gericht', 'ermöglichen', 'gewährung', 'obliegt', 'erster', 'linie', 'zweck', 'beachten', 'ihnen', 'verfassungsrechtlich', 'gewährleisten', 'dürfen', 'bislang', 'dezember', 'gewährt', 'hinblick', 'gesetzliche', 'regelung', 'bereits', 'vorliegende', 'sinn', 'erscheint', 'fragen', 'können', 'erfordert', 'darf', 'fachgerichtliche', 'berücksichtigung', 'finden', 'soweit', 'maßstäbe', 'abwägung', 'hinreichend', 'geklärt', 'sache', 'etwa', 'regelmäßig', 'bestimmten', 'immer', 'gewähren', 'entscheiden', 'einschätzung', 'hinreichenden', 'folgenden', 'maßstab', 'zugrunde', 'gelegt', 'generell', 'fälle', 'beschränkt', 'gerichten', 'hierfür', 'ausdrücklich', 'straftaten', 'entspricht', 'stand', 'verweist', 'würdigung', 'klärung', 'entzogen', 'derart', 'offen', 'gerichtliche', 'maßgebliche', 'zudem', 'akten', 'weiteren', 'wege', 'verordnung', 'freien', 'hamburg', 'april', 'vollzug', 'setzen', 'anderer', 'enthalten', 'antragsteller', 'abgelehnt', 'subsidiarität', 'gerecht', 'gehalten', 'möglichkeiten', 'rechtsschutzes', 'nutzen', 'märz', 'seine', 'kommt', 'frau', 'juni', 'richterinnen', 'britz', 'zeigt', 'gebotenen', 'vorliegen', 'voraussetzungen', 'verfassungsgerichtlichen', 'bestehende', 'erlangen', 'sofern', 'ausnahmsweise', 'unzumutbar', 'dargelegt', 'bestehenden', 'erschöpft', 'grundlage', 'verhandlung', 'ergangen', 'eröffnet', 'möglichkeit', 'erneuten', 'gerichtlichen', 'gestellt', 'warum', 'sollte', 'inanspruchnahme', 'legt', 'behauptung', 'befürchten', 'rechtzeitig', 'keinerlei', 'übrigen', 'rechtsweg', 'inhalt', 'beschlusses', 'vorläufige', 'teil', 'getroffen', 'antrags', 'welchen', 'gründen', 'rechtswegs', 'ebenso', 'wenig', 'falls', 'verwiesen', 'klage', 'verwaltungsgericht', 'hinsichtlich', 'bevollmächtigte', 'präsidenten', 'richterin', 'berücksichtigen', 'grundrechtsschutz', 'wahrscheinlichkeit', 'nachteilen', 'oberverwaltungsgericht', 'vorläufigen', 'einschränkung', 'kinder', 'menschen', 'wonach', 'schweren', 'darstellt', 'nachdem', 'beschränkung', 'zahl', 'raum', 'festsetzung', 'baer', 'wert', 'anwaltlichen', 'tätigkeit', 'euro', 'worten', 'festgesetzt', 'verwehrt', 'vollständig', 'belegt', 'überwiegend', 'zurückverwiesen', 'verfassungsbeschwerdeverfahren', 'ermessen', 'bestimmen', 'mindestens', 'allem', 'materiellen', 'darüber', 'beiordnung', 'sprechen', 'handelt', 'kammerentscheidung', 'maßgeblichen', 'waren', 'köln', 'urteile', 'verletzen', 'seinem', 'grundgesetzes', 'aufgehoben', 'land', 'notwendigen', 'auslagen', 'erstatten', 'musste', 'großen', 'zeitpunkt', 'hinweis', 'anhand', 'sicht', 'wollte', 'mehreren', 'jeweils', 'hatten', 'handele', 'bereich', 'rechtswidrig', 'gewesen', 'stelle', 'geschützten', 'interessen', 'keiner', 'veranlasst', 'informationen', 'jede', 'hohen', 'ausgegangen', 'sicherzustellen', 'zulässiger', 'beachtet', 'bewusst', 'genommen', 'späteren', 'bleibe', 'möglich', 'erfüllung', 'zuge', 'beziehungsweise', 'feststellungen', 'gebotene', 'bezogen', 'besonderheiten', 'unberücksichtigt', 'geblieben', 'justiz', 'ausgangsverfahrens', 'buchstabe', 'durchsetzung', 'grundrechte', 'angezeigt', 'schließt', 'demnach', 'schutz', 'erfasst', 'schutzbereich', 'findet', 'gehören', 'stützen', 'rüge', 'bestünden', 'substantiiert', 'somit', 'freie', 'begründen', 'gegebenenfalls', 'gesetzlichen', 'nachprüfung', 'begrenzt', 'normen', 'andererseits', 'angemessen', 'sehr', 'persönliche', 'vorliegenden', 'vorgaben', 'hierbei', 'begegnet', 'stellt', 'bundesgerichtshofs', 'unterliegen', 'juris', 'praxis', 'verfassungsrechtlicher', 'gesichtspunkt', 'davon', 'ausgehen', 'legen', 'wurden', 'notwendige', 'teilweise', 'überhaupt', 'arbeit', 'verantwortung', 'deshalb', 'entgegen', 'beiden', 'trotz', 'damaligen', 'erheblichen', 'dennoch', 'öffentlicher', 'zustimmung', 'ausgeschlossen', 'prüfung', 'umstand', 'gehen', 'erwägungen', 'verstoß', 'könnten', 'gesichtspunkte', 'festgestellt', 'fehlende', 'könnte', 'verlangt', 'gerichtlich', 'behauptet', 'widerspruch', 'ergibt', 'konnte', 'hierzu', 'erforderlichen', 'treffen', 'führt', 'weshalb', 'grundsätzlichen', 'beruhen', 'vermeidung', 'zwei', 'aufzuheben', 'zurückzuverweisen', 'klären', 'wahrung', 'auszuschließen', 'kommen', 'festgestellten', 'erstattung', 'folgt', 'beruht', 'vertreten', 'beschwerdeführerin', 'lange', 'beklagte', 'befasst', 'kläger', 'jahr', 'unternehmen', 'stellung', 'wirtschaftliche', 'entwicklung', 'rechtliche', 'heißt', 'abschluss', 'weiterhin', 'stets', 'wieder', 'schwierigkeiten', 'dahingehend', 'ende', 'unterlassen', 'ausschluss', 'geeignet', 'tatsachen', 'zweifelhaft', 'mehr', 'sachverhalt', 'zumindest', 'führen', 'ausreichend', 'bestanden', 'jahre', 'annahme', 'ausreichende', 'hiergegen', 'gerichtete', 'zulassung', 'verweis', 'daran', 'abgeschlossen', 'erneut', 'geschehen', 'anlass', 'solcher', 'hinaus', 'sehen', 'müsste', 'mittel', 'eingeschränkt', 'beendigung', 'bundesgerichtshof', 'mangels', 'gebrauch', 'hält', 'vorgelegen', 'gibt', 'statt', 'namentlich', 'zulässigen', 'ihren', 'hinsicht', 'eigenen', 'grenzen', 'schutzes', 'gehört', 'aufgaben', 'indem', 'zukunft', 'beschränken', 'verfassungsbeschwerden', 'eingreifen', 'rechtsanwendung', 'überprüfung', 'erstreckt', 'unrichtigen', 'anschauung', 'grundrechts', 'einfachen', 'rechts', 'ergebnis', 'hängt', 'einzelfalls', 'ihres', 'verhaltens', 'ausdruck', 'diejenigen', 'etwas', 'anderes', 'hingegen', 'betreffende', 'will', 'bisher', 'beeinträchtigt', 'beeinträchtigung', 'daraus', 'einzelne', 'vielzahl', 'bverfgk', 'dafür', 'aller', 'ihrem', 'gesamten', 'möglichst', 'entsprechend', 'hinter', 'erheblich', 'machen', 'lässt', 'entstehen', 'früheren', 'betreffenden', 'mehrere', 'erstmals', 'welche', 'bestehen', 'außerdem', 'verlangen', 'gegenstand', 'weiteres', 'zugänglich', 'eher', 'privaten', 'schwere', 'gemeinsamen', 'voraussetzung', 'demokratischen', 'sowohl', 'wahl', 'wirtschaftlichen', 'aussage', 'bloßen', 'getroffenen', 'tragweite', 'anerkennung', 'geltend', 'gemachten', 'erkennen', 'berührt', 'sozialen', 'leben', 'dargetan', 'einbeziehung', 'derjenigen', 'insgesamt', 'unzulässige', 'willkürlich', 'tätig', 'zwischenzeitlich', 'vergangenheit', 'liegenden', 'fehler', 'besteht', 'jeweilige', 'begründete', 'ausführungen', 'aufgabe', 'jeden', 'zugleich', 'außerhalb', 'aufhebung', 'oberverwaltungsgerichts', 'vizepräsidenten', 'auslagenerstattung', 'kosten', 'entspreche', 'angegriffen', 'betroffen', 'nachträglich', 'setzt', 'voraus', 'dahinstehen', 'landes', 'ausgangsverfahren', 'badenwürttemberg', 'verworfen', 'begehrt', 'zurückgewiesen', 'bedarf', 'stellungnahmen', 'mitwirkung', 'berufen', 'rechtfertigen', 'ablehnung', 'frühere', 'bestimmt', 'bedeutet', 'erfolgt', 'angefochtenen', 'bestimmter', 'geäußert', 'rechtsauffassung', 'rechtlich', 'wiederholt', 'mitglieder', 'fehlt', 'darlegung', 'anhörung', 'erforderliche', 'erfolgten', 'inhaltlich', 'näher', 'angaben', 'neben', 'vorlage', 'ermöglicht', 'strengen', 'eltern', 'feststellen', 'beurteilen', 'situation', 'allenfalls', 'entsprechen', 'bundestages', 'präsident', 'voßkuhle', 'huber', 'hermanns', 'kessalwulf', 'schreiben', 'gesetzlich', 'verpflichtet', 'drei', 'alle', 'geltenden', 'anfang', 'vwgo', 'eigene', 'bundesrepublik', 'europäischen', 'verhältnis', 'fällen', 'letzten', 'verwaltungsgerichts', 'frei', 'legte', 'beantragte', 'hilfsweise', 'gefahren', 'müssten', 'schriftsatz', 'seiten', 'frist', 'lehnte', 'angegriffene', 'rügen', 'grundrechtsgleichen', 'kenntnis', 'vortrag', 'parteien', 'prozessualen', 'fällt', 'reichweite', 'hieraus', 'hauptsacheverfahren', 'wären', 'fünf', 'hiervon', 'risiko', 'entsprechende', 'amts', 'wirksamkeit', 'verbundene', 'beteiligt', 'führte', 'umfassend', 'ermittlungen', 'anhaltspunkte', 'stellte', 'behauptete', 'beide', 'anträge', 'aussetzung', 'gerügten', 'macht', 'vorbringen', 'erhoben', 'gebietet', 'besonderer', 'gehör', 'bringen', 'ging', 'geben', 'ihrerseits', 'hinzu', 'unterschiedlichen', 'vergleich', 'neue', 'mündlichen', 'umso', 'gefunden', 'gesetzt', 'gerichts', 'erforderlich', 'welcher', 'reicht', 'münchen', 'feststellung', 'beschlüsse', 'welches', 'vier', 'gerichtshof', 'grundsatzes', 'falle', 'maßnahmen', 'unverhältnismäßig', 'aufgeworfenen', 'entwickelten', 'sichern', 'durchführung', 'abschließend', 'erfolgen', 'auseinander', 'vorgenommen', 'auseinandergesetzt', 'sollen', 'gekommen', 'bayerischen', 'änderung', 'prof', 'wenden', 'umsetzung', 'fest', 'nahe', 'ablauf', 'nähere', 'ausgestaltung', 'behandelt', 'bundestag', 'bundesregierung', 'blieben', 'führe', 'verstoße', 'bedingungen', 'unmittelbare', 'sonstigen', 'halbsatz', 'zulässige', 'entweder', 'erhobene', 'rücksicht', 'maßnahme', 'keinem', 'prinzip', 'auszugehen', 'einrichtung', 'sonstige', 'gutachten', 'gesetzgebers', 'maßgabe', 'erklärte', 'grundsätze', 'völlig', 'weit', 'lediglich', 'unvereinbar', 'auszulegen', 'grundlegend', 'ziele', 'aufl', 'kommentar', 'gleichwohl', 'verfolgte', 'vereinbar', 'verfolgten', 'notwendig', 'hierdurch', 'vorgesehenen', 'darstellen', 'natur', 'verstoßes', 'fehlen', 'anders', 'enthält', 'ausmaß', 'einzelner', 'hand', 'bundesverwaltungsgerichts', 'gleich', 'anlage', 'zuständige', 'behörde', 'erfolglos', 'zumutbar', 'gestellten', 'behörden', 'rede', 'stehenden', 'wesentlich', 'nunmehr', 'bewilligung', 'rechtsanwalt', 'erledigt', 'bescheid', 'ordnete', 'erhob', 'fehle', 'geltende', 'jeder', 'erteilt', 'vorgesehene', 'geführt', 'geändert', 'erhalten', 'verwaltung', 'anhörungsrüge', 'beantragt', 'fehlenden', 'bundesministerium', 'gerügt', 'effektiven', 'richterlichen', 'rechtsschutz', 'akte', 'tatsächlich', 'wirksam', 'staatlicher', 'regelfall', 'gebot', 'abhängig', 'allen', 'solange', 'gegenwärtig', 'rechtsmittel', 'erfüllt', 'geprüft', 'sachlichen', 'bverwge', 'unerheblich', 'auffassung', 'persönlichen', 'zuständigen', 'kraft', 'vermeiden', 'dargelegten', 'dürfte', 'erschwert', 'grundrechtsverletzung', 'mitgeteilt', 'sicherheit', 'derzeit', 'gebe', 'bestehe', 'sichergestellt', 'ursprünglich', 'gefährdung', 'lage', 'sommer', 'heute', 'sachverhalts', 'maße', 'nahm', 'getroffene', 'behandlung', 'rechtliches', 'beanstandet', 'grundsätzliche', 'gerichteten', 'einklang', 'beurteilt', 'liegende', 'jetzt', 'notwendigkeit', 'umfassenden', 'bezieht', 'erwägung', 'gezogen', 'angeordnet', 'entsprechenden', 'zweifel', 'willen', 'beachtung', 'solches', 'erreicht', 'ergebenden', 'entnehmen', 'tatsächlichen', 'verfassungs', 'möglichen', 'durchaus', 'eingriffs', 'festzustellen', 'erkenntnisse', 'erkannt', 'gmbh', 'geworden', 'begehren', 'lägen', 'überschritten', 'beteiligung', 'mache', 'system', 'befugnis', 'dürfe', 'zuvor', 'beruhe', 'gehe', 'wahrnehmung', 'gehandelt', 'ergebe', 'unterschied', 'beteiligten', 'seite', 'staates', 'unterschiedliche', 'bloße', 'verschiedenen', 'geschützt', 'begriff', 'bayern', 'ferner', 'mithin', 'unterstellt', 'bezeichnet', 'gelte', 'einhaltung', 'ließen', 'pflicht', 'ausgeführt', 'wortlaut', 'beanstanden', 'geschützte', 'verfassungsrechtliche', 'nichts', 'gehindert', 'vermögen', 'gesellschaft', 'folge', 'gleicher', 'dienen', 'bürger', 'umfasst', 'objektiv', 'lasten', 'berechtigt', 'jedes', 'nvwz', 'verstößt', 'argumentation', 'geltung', 'ausübung', 'nutzung', 'gleiches', 'bedürfen', 'betrachtung', 'weiterer', 'tatsächlicher', 'unterschiede', 'gebunden', 'literatur', 'vermag', 'zusätzliche', 'ändert', 'tatsache', 'sogenannten', 'sodann', 'trifft', 'zweite', 'handeln', 'indes', 'schließen', 'beispielsweise', 'geschlossen', 'vorgelegt', 'erhobenen', 'enthaltenen', 'umfassende', 'zwingend', 'rechtfertigung', 'angemessenen', 'gelassen', 'vorliege', 'abweichende', 'erscheinen', 'pflichten', 'dient', 'freistaat', 'versagung', 'ländern', 'gleichzeitig', 'blieb', 'komme', 'dahin', 'verfassungswidrig', 'leistung', 'norm', 'rechtmäßigkeit', 'vorschrift', 'verfassungsmäßigkeit', 'regelungen', 'stünden', 'mögliche', 'verletze', 'schaffung', 'kontrolle', 'rechtlicher', 'angemessene', 'verhältnismäßigkeit', 'sicherung', 'belastung', 'gesetzgeberischen', 'belange', 'verkennt', 'tatsächliche', 'eintritt', 'verfassung', 'bisherige', 'gelangt', 'republik', 'zugelassen', 'übertragen', 'geregelt', 'straße', 'papier', 'aufklärung', 'erwarten', 'ansicht', 'verfassungsrecht', 'enthalte', 'verstehen', 'rolle', 'rechnen', 'dritter', 'rechtsordnung', 'verhältnismäßig', 'hiernach', 'durchgeführt', 'anwendungsbereich', 'deswegen', 'dritte', 'ausgleich', 'angesehen', 'gleichheitssatz', 'bestand', 'bundes', 'eingeräumt', 'welchem', 'jedem', 'engeren', 'grenze', 'gewährleistung', 'vorzunehmen', 'beschwerdeführern', 'zuletzt', 'entfallen', 'vorgesehen', 'einschränkungen', 'ausprägung', 'erhebung', 'gemachte', 'verhindern', 'beseitigen', 'beziehen', 'verfassungsverstoß', 'häufig', 'vorliegt', 'bestimmungen', 'auswirkungen', 'unrecht', 'schützen', 'zusammen', 'familie', 'rechtsanwalts', 'unmittelbaren', 'verpflichtung', 'gesamte', 'festlegung', 'zusätzlich', 'rechtslage', 'neuregelung', 'ermittlung', 'schaffen', 'erheben', 'einmal', 'mittelbar', 'leistungen', 'höhe', 'stuttgart', 'entsprechender', 'bezüglich', 'ansprüche', 'verkannt', 'anzusehen', 'annahmevoraussetzungen', 'zwecke', 'verfolgt', 'bestimmung', 'finanziellen', 'abgestellt', 'bietet', 'ständigen', 'machte', 'einbezogen', 'gebracht', 'verletzten', 'begrenzung', 'beschlüssen', 'setzte', 'vertrauen', 'stattgebende', 'wohnung', 'etwaige', 'überprüft', 'getreten', 'länder', 'bundesverwaltungsgericht', 'bverwg', 'bejaht', 'verhältnisse', 'rechtfertigt', 'regelt', 'überprüfen', 'ungleichbehandlung', 'differenzierung', 'bisherigen', 'einschlägigen', 'einlegung', 'frankfurt', 'main', 'zahlung', 'aufgenommen', 'richters', 'konnten', 'wesentliche', 'überlassen', 'erfüllen', 'tritt', 'spätestens', 'förderung', 'willkürverbot', 'hilfe', 'eingegangen', 'wiederum', 'halte', 'überdies', 'grunde', 'faktisch', 'aspekt', 'vertretbar', 'schluss', 'gesehen', 'rechtsstaatlichen', 'wolle', 'eigener', 'diene', 'anwendbar', 'bindung', 'vorgelegten', 'inkrafttreten', 'beklagten', 'rechtsanwältin', 'einführung', 'änderungen', 'ohnehin', 'bezeichneten', 'tage', 'verneint', 'verfolgung', 'anzuwenden', 'präsidentin', 'sollten', 'geschaffen', 'btdrucks', 'erste', 'genüge', 'kaum', 'zuständigkeit', 'bedürfe', 'unbedenklich', 'gesetzlicher', 'doch', 'bund', 'gleiche', 'konkretisierung', 'ausgelegt', 'verständnis', 'gestaltung', 'verwirklichung', 'hohe', 'vorrang', 'herangezogen', 'einerseits', 'sachliche', 'hälfte', 'überzeugung', 'entscheidungserheblich', 'belastet', 'behandeln', 'gruppe', 'ausweislich', 'sachverständigen', 'inzwischen', 'deutscher', 'hömig', 'vorgenommene', 'partner', 'monate', 'sachlich', 'wirksame', 'rechtsanwälte', 'vertretenen', 'düsseldorf', 'gegebenen', 'rechtsstaatsprinzip', 'fabio', 'hassemer', 'jaeger', 'gerhardt', 'landau', 'lübbewolff', 'kirchhof', 'osterloh', 'eichberger', 'sozietät', 'koll', 'limbach', 'jentsch', 'schluckebier', 'bryde', 'gaier', 'mellinghoff', 'hoffmannriem', 'steiner', 'broß', 'hohmanndennhardt', 'beschluß', "antragstellerin", "antragsteller", "antragsgegner", "juris", "juris", "datum", "beschwerdeführender", "beschwerdeführender", "beschwerdeführend", "beschwerdeführenden", "beschwerdeführenden", "beschwerdeführerinn", "anwaltlich", "monat", "beschluß", "euro", "rechtsreferendarin", "vorabkontrolle", "verfassungsbeschwerde", "beschluß", "artikel", "kläger", "behörde", "buch", "schriftsatz", "abschnitt", "begriff", "sonstig", "kapitel", "abschnitt", "zweck", "sachgebiet", "bund", "land", "bundesland", "oberverwaltungsgericht", "verwaltungsgerichtshof", "deutsch", "bayerisch", "gerichtshof", "regierung", "bundestag", "bundesregierung", "bundeskanzler", "bundespräsident", "bundesminister", "deutsch", "eingriffsschwell", "anhörungsrug", "richterlich", "politisch", "statistisch", "euro", "baer", "benda", "berger", "britz", "broß", "bryde", "böckenförde", "böhmer", "christ", "difabio", "dieterich", "drath", "eichberger", "ellinghaus", "faller", "federer", "friesenhahn", "fröhlich", "gaier", "geiger", "gerhardt", "graßhof", "grimm", "hjrinck", "haas", "harbarth", "hassemer", "heck", "heiland", "henneka", "henschel", "hermanns", "herzog", "hesse", "heußner", "hoffmannriem", "hohmanndennhard", "huber", "härtel", "hömig", "höpkeraschoff", "jentsch", "jäger", "katz", "katzenstein", "kessalwulf", "kirchhof", "klaas", "klein", "kruis", "könig", "kühling", "landau", "langenfeld", "lehmann", "leusser", "limbach", "lübbewolff", "mahrenholz", "maidowski", "masing", "mellinghoff", "müller", "niebler", "niedermaier", "niemeyer", "osterloh", "ott", "papier", "paulus", "radtke", "rinck", "ritterspach", "roediger", "rottmann", "rupp", "scheffler", "schluckebier", "scholtissek", "seibert", "seidl", "simon", "sommer", "stein", "steinberger", "steiner", "söllner", "träger", "voßkuhle", "wallrabenstein", "wand", "wessel", "winter", "wintrich", "wolff", "zeidler", "zweigert"]
    print(type(stop_words))
    stop_words = list(stop_words)
    #print('original len(stop_words):', len(stop_words))
    #additional_list = ['Antragstellerin', 'Antragsteller', 'Antragsgegner', 'Juris', 'juris', 'Datum', 'beschwerdeführender', 'Beschwerdeführender', 'beschwerdeführend', 'beschwerdeführenden', 'Beschwerdeführenden', 'Beschwerdeführerinn', 'anwaltlich', 'Monat', 'Beschluß', 'Euro', 'Rechtsreferendarin', 'Vorabkontrolle', 'Verfassungsbeschwerde', 'Beschluß', 'ARTIKEL', 'Kläger', 'Behörde', 'Buch', 'Schriftsatz', 'Abschnitt', 'Begriff', 'sonstig', 'Kapitel', 'Abschnitt', 'Zweck', 'Sachgebiet', 'Bund', 'Land', 'Bundesland', 'Oberverwaltungsgericht', 'Verwaltungsgerichtshof', 'deutsch', 'bayerisch', 'Gerichtshof', 'Regierung', 'Bundestag', 'Bundesregierung', 'Bundeskanzler', 'Bundespräsident', 'Bundesminister', 'deutsch', 'Eingriffsschwell', 'Anhörungsrug', 'richterlich', 'politisch', 'statistisch', 'Euro', 'Baer', 'Benda', 'Berger', 'Britz', 'Broß', 'Bryde', 'Böckenförde', 'Böhmer', 'Christ', 'DiFabio', 'Dieterich', 'Drath', 'Eichberger', 'Ellinghaus', 'Faller', 'Federer', 'Friesenhahn', 'Fröhlich', 'Gaier', 'Geiger', 'Gerhardt', 'Graßhof', 'Grimm', 'HJRinck', 'Haas', 'Harbarth', 'Hassemer', 'Heck', 'Heiland', 'Henneka', 'Henschel', 'Hermanns', 'Herzog', 'Hesse', 'Heußner', 'HoffmannRiem', 'HohmannDennhard', 'Huber', 'Härtel', 'Hömig', 'HöpkerAschoff', 'Jentsch', 'Jäger', 'Katz', 'Katzenstein', 'KessalWulf', 'Kirchhof', 'Klaas', 'Klein', 'Kruis', 'König', 'Kühling', 'Landau', 'Langenfeld', 'Lehmann', 'Leusser', 'Limbach', 'LübbeWolff', 'Mahrenholz', 'Maidowski', 'Masing', 'Mellinghoff', 'Müller', 'Niebler', 'Niedermaier', 'Niemeyer', 'Osterloh', 'Ott', 'Papier', 'Paulus', 'Radtke', 'Rinck', 'Ritterspach', 'Roediger', 'Rottmann', 'Rupp', 'Scheffler', 'Schluckebier', 'Scholtissek', 'Seibert', 'Seidl', 'Simon', 'Sommer', 'Stein', 'Steinberger', 'Steiner', 'Söllner', 'Träger', 'Voßkuhle', 'Wallrabenstein', 'Wand', 'Wessel', 'Winter', 'Wintrich', 'Wolff', 'Zeidler', 'Zweigert']
    #stop_words = stop_words + additional_list
    print('stop_words:', stop_words)
    print('set(stop_words):', set(stop_words))
    print('len(stop_words):', len(stop_words))
    print('type(stop_words):', type(stop_words))
    print('len(set(stop_words)):', len(set(stop_words)))

    '''
    stop_words_set = set(stop_words)
    
    word_tokens = word_tokenize(text)
    filtered_text = [w for w in word_tokens if not w in stop_words_set]
    filtered_text = ' '.join([w for w in filtered_text])
    #print('filtered_text:', filtered_text)
    print('stop_words_set:', stop_words_set)
    print('len(stop_words_set):', len(stop_words_set))
    return filtered_text
    '''
    delete_dict = {sp_character: '' for sp_character in string.punctuation} 
    delete_dict[' '] = ' ' 
    table = str.maketrans(delete_dict)
    text1 = text.translate(table)
    #print('cleaned:'+text1)
    textArr= text1.lower().split()
    #textArr = text1.split()
    #delete tokens that contains number, tokens in stop word list, and too short tokens
    text2 = ' '.join([w for w in textArr if (not any(char.isdigit() for char in w)) and (not w in stop_words) and len(w)>3])
    #print('text2:', text2)
    return text2 




def read_cases(filename, limit=-1):
    col_list = ["bverfg_id_forward", "full_text"]
    #col_list = ["full_text"]

    if limit > 0:
        df_full_text = pd.read_csv(filename, usecols=col_list, nrows=limit)
    else:
        df_full_text = pd.read_csv(filename, usecols=col_list)

    df_full_text.dropna(axis = 0, how ='any',inplace=True) 

    df_full_text['full_text'] = df_full_text['full_text'].apply(clean_text)
    print('after clean-text:', df_full_text['full_text'][0:3])
    text_list = lemmatization(df_full_text)
    print('text_list after lemmatization:', text_list)


    dictionary, doc_term_matrix = create_term_matrix(text_list)
    
    return dictionary, doc_term_matrix


def lemmatization(text_df, allowed_postags=['NOUN', 'ADJ']):
    nlp = spacy.load('de_core_news_md', disable=['parser', 'ner'])
    texts = text_df['full_text'].tolist()    
    output = []
    for sent in texts:
        doc = nlp(sent)     
        output.append([token.lemma_ for token in doc if token.pos_ in allowed_postags])
    return output


def create_term_matrix(tokenized_rulings):
    dictionary = corpora.Dictionary(tokenized_rulings)
    doc_term_matrix = [dictionary.doc2bow(rul) for rul in tokenized_rulings]

    return dictionary, doc_term_matrix